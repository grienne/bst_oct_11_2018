---
title: "H4"
author: "grienne"
date: "October 12, 2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r Foundation}
library(readxl)
library(ggplot2)
library(dplyr)
library(ResourceSelection)

dat <- read_excel("oct_11_2018_h4_table_7_18.xlsx")

dat_try <- read_excel("dat_comp.xlsx")

names(dat) <- c('wais', 'symptom')

```

```{Question 1}

Question 1

A. For the simple logistic model πi = eβi/(1 + eβi), show that if there is no diﬀerence between the exposed (b1)
    and not exposed groups (b2) (i.e., β1 = β2), then φ = 1
      
       
    
          Set φ = 1 = [ π1/ (1 − π2) ] / [ π2 (1 − π1) ] =>
                
                Cross Multiply   
                   [ π1/ (1 − π2) ] = [ π2 (1 − π1) ]
                  Multiply Out
                    π1 − π1π2 = π2 − π1π2
                    Algebra
                        π1 = π2
                      Express
                        eβ1/(1 + eβ1) =  eβ2/(1 + eβ2)
                        Cross Multiply
                          eβ1*(1 + eβ2) =  eβ2*(1 + eβ1)
                          Multiply Out 
                            eβ1 + eβ1eβ2) =  eβ2 + eβ1eβ2
                            Algebra
                              eβ1 = eβ2
                              Log
                                β1 = β2 if and only if β1 = β2
                          
      
B. Consider J 2 × 2 tables like Table 7.13, one for each level xj of a factor, such as age group, with j = 1,...,J. 
    For the logistic model
      πij = exp(αi + βixj) / 1 + exp(αi + βixj), i = 1,2, j = 1,...,J.
        Show that log φ is constant over all tables if β1 = β2   

              if φ = exp(π1 - π2)
                then   log φ = (alpha1 - alpha2) + xj(β1 - β2) if β1 = β2
        
                
        
```

```{r Question 2}
#Problem 2

#(a)Confirm the first 4 columns of Table 7.9.
 
count<-aggregate( data=dat,symptom~wais,length)
count2<-aggregate( data=dat,symptom~wais,sum)
names(count) <- c("wais", "total_symp_count")
tbl <- merge(count, count2, by ='wais', all = T)
tbl$no_symp<- (tbl$total_symp_count - tbl$symptom)
names(tbl) <- c("wais", "total_symp_count", "yes_symp", "no_symp", "no_symp_remove") 
 
#calculate prop
tbl$prop<- (tbl$yes_symp/tbl$total_symp_count)
 
#(b)Confirm the estimation of the B's and corresponding standard errors
p2_fit=glm(prop~wais, data=tbl,family=binomial(link="logit"))
summary(p2_fit)
coef(p2_fit)
 
#(c)Verify the Hosmer-Lemeshow test statistic
###Gyeon Review 
hl <- hoslem.test(tbl$total_symp_count, fitted(p2_fit), g=10)
hl
 
h2 <- hoslem.test(p2_fit$y, fitted(p2_fit), g=10)
h2

#(d)Replicate the plot in Figure 7.5.

#(d) Replicate the plot in Figure 7.5.

p <- ggplot(data = tbl, aes(x=wais, y=prop))
p + geom_point() + geom_smooth(method = "glm", se = FALSE) 

#(e)
  #With increasing WAIS scores, chances of senility are reduced. 

```


```{ Question 3}

Git ID - grienne

```

```{Question 4}

Certificate also stored in git
Git-Link: https://github.com/grienne/bst_oct_11_2018.git

Completion Date 26-Aug-2018
Expiration Date 25-Aug-2021
Record ID 28316665
Verify at www.citiprogram.org/verify/?w493f4f53-6552-4fb1-8285-a171d8d5bba0-28316665
```